<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>税込・税抜・消費税計算ツール｜秒速税計算</title>
  <meta name="description" content="税込・税抜・消費税（10%/8%/任意）をすぐ計算できる無料ツール。金額を入れるだけで税額と税込/税抜を表示します。" />
  <style>
    body{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      margin:0; background:#fff; color:#111; line-height:1.6;}
    .wrap{max-width:720px; margin:0 auto; padding:20px;}
    h1{font-size:22px; margin:0 0 6px;}
    .sub{color:#555; margin:0 0 16px; font-size:14px;}
    nav{margin:14px 0 18px; display:flex; gap:12px; flex-wrap:wrap;}
    nav a{color:#111; text-decoration:underline;}
    .card{border:1px solid #e6e6e6; border-radius:12px; padding:16px; margin:14px 0;}
    label{display:block; font-size:13px; color:#333; margin:10px 0 6px;}
    input, select{width:100%; padding:12px; border:1px solid #d9d9d9; border-radius:10px; font-size:16px;}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    .btns{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px;}
    button{padding:12px; border-radius:10px; border:1px solid #111; background:#111; color:#fff; font-size:16px; cursor:pointer;}
    button.secondary{background:#fff; color:#111;}
    .result{font-size:20px; font-weight:700; margin-top:10px;}
    .muted{color:#666; font-size:13px;}
    hr{border:none; border-top:1px solid #eee; margin:18px 0;}
    .kpi{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;}
    .box{border:1px solid #eee; border-radius:10px; padding:10px;}
    .box .t{font-size:12px; color:#666;}
    .box .v{font-size:18px; font-weight:700; margin-top:4px;}
    footer{margin:24px 0 8px; color:#666; font-size:12px;}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>秒速税計算（消費税・税込・税抜）</h1>
    <p class="sub">金額と税率を入れるだけ。税込／税抜／税額を一発表示。</p>

    <nav>
      <a href="privacy.html">プライバシーポリシー</a>
      <a href="howto.html">使い方</a>
      <a href="contact.html">お問い合わせ</a>
      <!-- 1つ目のサイトURLに差し替え -->
      <a href="https://percent-app.vercel.app">割合ツール（総合）</a>
    </nav>

    <div class="card">
      <label>金額</label>
      <input id="amount" inputmode="decimal" placeholder="例：10000" />

      <div class="row">
        <div>
          <label>税率</label>
          <select id="rate">
            <option value="0.10">10%（標準）</option>
            <option value="0.08">8%（軽減）</option>
            <option value="custom">任意</option>
          </select>
        </div>
        <div>
          <label>任意税率（%）</label>
          <input id="customRate" inputmode="decimal" placeholder="例：5" disabled />
        </div>
      </div>

      <div class="btns">
        <button id="toTaxIn">税抜 → 税込</button>
        <button id="toTaxOut" class="secondary">税込 → 税抜</button>
      </div>

      <div class="kpi">
        <div class="box">
          <div class="t">税抜価格</div>
          <div class="v" id="taxOut">—</div>
        </div>
        <div class="box">
          <div class="t">税込価格</div>
          <div class="v" id="taxIn">—</div>
        </div>
        <div class="box">
          <div class="t">消費税（税額）</div>
          <div class="v" id="tax">—</div>
        </div>
        <div class="box">
          <div class="t">税率</div>
          <div class="v" id="rateView">—</div>
        </div>
      </div>

      <p class="muted">※ 小数は四捨五入（円単位）で表示します。</p>
    </div>

    <hr>

    <h2>このツールでできること</h2>
    <p>
      「税抜→税込」「税込→税抜」をすぐに計算できます。10%・8%だけでなく、任意の税率にも対応しています。
      見積もり、請求、買い物の計算など、日常の確認にご利用ください。
    </p>

    <h2>計算式</h2>
    <ul>
      <li>税込 = 税抜 × (1 + 税率)</li>
      <li>税抜 = 税込 ÷ (1 + 税率)</li>
      <li>税額 = 税込 − 税抜</li>
    </ul>

    <footer>© 秒速税計算</footer>
  </div>

<script>
  const $ = (id) => document.getElementById(id);

  const fmtYen = (n) => {
    if (!isFinite(n)) return "—";
    const rounded = Math.round(n);
    return "¥" + rounded.toLocaleString("ja-JP");
  };

  const getRate = () => {
    const v = $("rate").value;
    if (v === "custom") {
      const cr = parseFloat(($("customRate").value || "").replace(/,/g,""));
      if (!isFinite(cr)) return NaN;
      return cr / 100;
    }
    return parseFloat(v);
  };

  const getAmount = () => {
    const a = parseFloat(($("amount").value || "").replace(/,/g,""));
    return isFinite(a) ? a : NaN;
  };

  const render = (taxOut, taxIn, tax, rate) => {
    $("taxOut").textContent = fmtYen(taxOut);
    $("taxIn").textContent  = fmtYen(taxIn);
    $("tax").textContent    = fmtYen(tax);
    $("rateView").textContent = isFinite(rate) ? (rate*100).toFixed(2).replace(/\.00$/,'') + "%" : "—";
  };

  const calcFromTaxOut = () => {
    const amt = getAmount();
    const r = getRate();
    if (!isFinite(amt) || !isFinite(r)) return render(NaN, NaN, NaN, r);
    const taxIn = amt * (1 + r);
    const tax = taxIn - amt;
    render(amt, taxIn, tax, r);
  };

  const calcFromTaxIn = () => {
    const amt = getAmount();
    const r = getRate();
    if (!isFinite(amt) || !isFinite(r)) return render(NaN, NaN, NaN, r);
    const taxOut = amt / (1 + r);
    const tax = amt - taxOut;
    render(taxOut, amt, tax, r);
  };

  $("rate").addEventListener("change", () => {
    const isCustom = $("rate").value === "custom";
    $("customRate").disabled = !isCustom;
    if (!isCustom) $("customRate").value = "";
    // 入力途中でも表示が更新されるように、直近の計算を再実行
    calcFromTaxOut();
  });

  $("customRate").addEventListener("input", () => calcFromTaxOut());
  $("amount").addEventListener("input", () => calcFromTaxOut());

  $("toTaxIn").addEventListener("click", (e) => { e.preventDefault(); calcFromTaxOut(); });
  $("toTaxOut").addEventListener("click", (e) => { e.preventDefault(); calcFromTaxIn(); });

  // 初期表示
  render(NaN, NaN, NaN, 0.10);
</script>
</body>
</html>
